

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Part 4: The Print Statement You Can Send Somewhere Else &mdash; PythonCert220 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Activity" href="activity.html" />
    <link rel="prev" title="Part 3: The Print Statement You Can Add To" href="content_part3.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PythonCert220
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Lesson content</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#py220-advanced-python-programming">Py220: Advanced Python Programming</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../lesson00/index.html">Welcome!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson01/index.html">Lesson 1 : Automated Testing</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Lesson 2 : Logging &amp; Debuging</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="content_part1.html">Part 1: Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part2.html">Part 2: The Print Statement You Can Hide</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part3.html">Part 3: The Print Statement You Can Add To</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Part 4: The Print Statement You Can Send Somewhere Else</a></li>
<li class="toctree-l4"><a class="reference internal" href="activity.html">Activity</a></li>
<li class="toctree-l4"><a class="reference internal" href="assignment.html">Assignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lesson03/index.html">Lesson 3 : Relational databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson04/index.html">Lesson 4 : Iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson05/index.html">Lesson 5 : Consuming APIs with NoSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson06/index.html">Lesson 6 : Profiling and performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson07/index.html">Lesson 7 : Currency and async</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson08/index.html">Lesson 8 : Functional Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson09/index.html">Lesson 9 : Advanced Python language constructs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson10/index.html">Lesson 10 : Metaprogramming</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PythonCert220</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Lesson content</a> &raquo;</li>
        
          <li><a href="index.html">Lesson 2 : Logging &amp; Debuging</a> &raquo;</li>
        
      <li>Part 4: The Print Statement You Can Send Somewhere Else</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/lesson02/content_part4.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="part-4-the-print-statement-you-can-send-somewhere-else">
<h1>Part 4: The Print Statement You Can Send Somewhere Else<a class="headerlink" href="#part-4-the-print-statement-you-can-send-somewhere-else" title="Permalink to this headline">¶</a></h1>
<p>Every print statement you include in your code writes its message to the
console, but what if it could be sent somewhere else?</p>
<p>The simplest place that you can send log messages to is a file. Edit
the&nbsp;<em>logging.basicConfig</em>statement in your&nbsp;<em>simple.py</em>.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">log_format</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mylog.log&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now run simple.py:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span>$ python simple.py

$
</pre></div>
</div>
<p>There should now be no output sent to the console. Instead, the logging
messages have been sent to a new file: mylog.log. Open this newly
created file to take a look at the contents.</p>
<p>What happens when you run the script again? Will the contents of
mylog.log be appended to, or will they be overwritten? Try it out and
find the answer. What’s in the log file after running simply.py two or
three times?</p>
<p>We’re really starting to show off the power of logging. Now you no
longer have to wait patiently at the console for your print statements
to be displayed: you can just send them to a file and read them later.</p>
<p>Logging is even more powerful than that. We’re about to learn how to
send our logging messages to multiple places. In preparation for that, I
want you to make the following changes to your code:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">log_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)-3d</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span>

<span class="c1"># BEGIN NEW STUFF</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_format</span><span class="p">)</span>

<span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;mylog.log&#39;</span><span class="p">)</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
<span class="c1"># END NEW STUFF</span>

<span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The value of i is 50.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Tried to divide by zero. Var i was </span><span class="si">{}</span><span class="s2">. Recovered gracefully.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">my_fun</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Python, and the logging library, are so easy to read that you can
probably guess at the meaning of all of these new lines. The first thing
to notice is that we’ve eliminated that&nbsp;<em>logging.basicConfig</em>&nbsp;line!
We’re manually building a logging configuration, consisting of
a&nbsp;<em>formatter</em>&nbsp;and a&nbsp;<em>handler</em>.</p>
<p>Let me add a bit of explanation to each new line in the following comments:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a &quot;formatter&quot; using our format string</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_format</span><span class="p">)</span>

<span class="c1"># Create a log message handler that sends output to the file &#39;mylog.log&#39;</span>
<span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;mylog.log&#39;</span><span class="p">)</span>
<span class="c1"># Set the formatter for this log message handler to the formatter we created above.</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="c1"># Get the &quot;root&quot; logger. More on that below.</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="c1"># Add our file_handler to the &quot;root&quot; logger&#39;s handlers.</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
</pre></div>
</div>
<p>What does this new configuration do? Well, it does exactly what our code
did before: it sends warning messages and above to a file named
‘mylog.log’.</p>
<p>Log message handlers answer the question, “What should the system do
with log messages?” Here are a few possible things that we can do with
them:</p>
<ul class="simple">
<li>We could print them to the console.</li>
<li>We could send them to a file.</li>
<li>We could send them to a remote server.</li>
<li>We could send them in an email.</li>
<li>We could just ignore them.</li>
</ul>
<p>Take a brief look at each of the <a class="reference external" href="https://docs.python.org/3/library/logging.handlers.html">handler classes available in the
logging
library</a>.
Each of the above ways to handle log messages, and more, is represented
by a handler class in the logging library.</p>
<p>In the newest iteration of our code, we create a logging.FileHandler log
message handler to send our log messages to a file. Unlike
the&nbsp;<em>logging.basicConfig</em>&nbsp;command, we can’t provide the log message
format to our file handler as a string. We have to create an instance of
the logging.Formatter class and use&nbsp;<em>file_handler.setFormatter</em>&nbsp;to
instruct our handler to use this formatter.</p>
<p>Next, we have to tell the logger to use this handler that we’ve created.
We first get a reference to the “root” or global logger
using&nbsp;<em>logging.getLogger()</em>. It turns out that you can have multiple
loggers running in a system, although we’re not going to explore that in
this lesson. Instead, we’re going to use a single logger and add
multiple log message handlers to that logger. But if you’re curious, you
can look at the documentation
for&nbsp;<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.getLogger">logging.getLogger()</a></p>
<p>Now that we have a reference to the “root” or global logger, we can add
our message handler to it using&nbsp;<em>logger.addHandler</em>. Now, our root
logger will send all of its messages to the file_handler log message
handler, and these messages get written to the file ‘mylog.log’.</p>
<p>Run the script and confirm!</p>
<p>Now, let’s add another handler! Imagine that you wanted to see ALL
logging messages at the console while you were running your program, but
only log the most important messages (WARNING and above) to your log
file. You could accomplish that with this code:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">log_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)-3d</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span>

<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_format</span><span class="p">)</span>

<span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;mylog.log&#39;</span><span class="p">)</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>           <span class="c1"># Add this line</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>        <span class="c1"># Add this line</span>
<span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>          <span class="c1"># Add this line</span>
<span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>          <span class="c1"># Add this line</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>                   <span class="c1"># Add this line</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>               <span class="c1"># Add this line</span>

<span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The value of i is 50.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Tried to divide by zero. Var i was </span><span class="si">{}</span><span class="s2">. Recovered gracefully.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">my_fun</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>You might have a few questions about this code:</p>
<ul class="simple">
<li>What is a StreamHandler?</li>
<li>Why do we set the log level on both of the log message
handlers&nbsp;<strong>and also</strong>&nbsp;set the log level on the root logger?</li>
</ul>
<p>A rigorous definition of a s<em>tream</em>&nbsp;is outside the scope of this
assignment; but in rough terms, a stream is a very general concept in
computer science of a store or source of information. The StreamHandler
constructor will accept a stream as its first argument; but if we don’t
provide an argument, then it will use its default: the sys.stderr
stream. That’s one of two system streams that get printed directly to
the console. So by default, the StreamHandler will send log messages to
the console.</p>
<p>As for the second question, loggers and handlers maintain separate
settings for their minimum log level. By default, a logger will not pass
any messages lower than WARNING on to its handlers. Because we want the
console_logger to handle DEBUG messages, we have to set the level of the
root logger to DEBUG in order for these messages to be sent on to its
handlers at all. Because we also set the level of the console_handler to
DEBUG, the console_handler will print out these low-level messages. The
root logger will also send DEBUG messages and above to the file_handler,
but because we have set the log level of the file_handler to WARNING it
will only log WARNING messages and above to its log file.</p>
<p>Run the script, and confirm that it now runs as expected!</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="activity.html" class="btn btn-neutral float-right" title="Activity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="content_part3.html" class="btn btn-neutral" title="Part 3: The Print Statement You Can Add To" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, University of Washington, Christopher Barker, Luis Diego Conejo, Andy Miles, Rick Riehle, Joseph Schilz. Creative Commons Attribution-ShareAlike 3.0 license

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>