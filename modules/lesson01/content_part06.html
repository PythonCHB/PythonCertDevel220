

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Part 6: Developing the test further &mdash; PythonCert220 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Activity" href="activity.html" />
    <link rel="prev" title="Part 5: Using Unittest" href="content_part05.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PythonCert220
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Lesson content</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#py220-advanced-python-programming">Py220: Advanced Python Programming</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../lesson00/index.html">Welcome!</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Lesson 1 : Automated Testing</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="content_part01.html">Part 1: Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part02.html">Part 2: Why test?</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part03.html">Part 3: Automated Test Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part04.html">Part 4: Running the script</a></li>
<li class="toctree-l4"><a class="reference internal" href="content_part05.html">Part 5: Using Unittest</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Part 6: Developing the test further</a></li>
<li class="toctree-l4"><a class="reference internal" href="activity.html">Activity</a></li>
<li class="toctree-l4"><a class="reference internal" href="assignment.html">Assignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lesson02/index.html">Lesson 2 : Logging &amp; Debuging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson03/index.html">Lesson 3 : Relational databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson04/index.html">Lesson 4 : Iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson05/index.html">Lesson 5 : Consuming APIs with NoSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson06/index.html">Lesson 6 : Profiling and performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson07/index.html">Lesson 7 : Currency and async</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson08/index.html">Lesson 8 : Functional Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson09/index.html">Lesson 9 : Advanced Python language constructs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lesson10/index.html">Lesson 10 : Metaprogramming</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PythonCert220</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Lesson content</a> &raquo;</li>
        
          <li><a href="index.html">Lesson 1 : Automated Testing</a> &raquo;</li>
        
      <li>Part 6: Developing the test further</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/lesson01/content_part06.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="part-6-developing-the-test-further">
<h1>Part 6: Developing the test further<a class="headerlink" href="#part-6-developing-the-test-further" title="Permalink to this headline">¶</a></h1>
<p>The TestCase class includes instance methods for making assertions about
the behavior of our program. The <em>assertEqual</em> method is an instance
method defined in the TestCase class: it helps us compare the expected
behavior of a program with its actual behavior. The first argument we
give it is the <em>expected</em> result of squaring our number <em>num</em>. Then
we give it the&nbsp;<em>actual</em> square that’s produced by Squarer.calc. We can
also specify an optional helpful message for the test library
to print if this test fails: our helpful message will tell us what
number we were trying to square when the test failed.</p>
<p>Here’s another difference: note that I didn’t include an <em>if
__name__==”__main__”</em> clause. We <em>won’t</em> be running this script
directly, instead we’ll invoke it indirectly through the unittest
library. You’ll see that below.</p>
<p>Finally, there’s one more difference between&nbsp;unittest and our original
test script&nbsp;that you should be aware of: unittest will stop
running a test method as soon as it finds a single assertion error. That
is to say, if test_positive_numbers finds that Squarer does not
produce 9 when squaring 3, then it <em>will</em> report that error but then
it won’t try any more numbers: it <a href="#id1"><span class="problematic" id="id2">*</span></a>won’t&nbsp;* also try squaring 12 to
see if it produces 144. The implication is that, for code that is more complex
it is possible that fixing one error reported by unittest will uncover
a new one.</p>
<p>Here’s the current content of our squarer.py file:</p>
<div
style#"background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># squarer.py</span>
<span class="k">class</span> <span class="nc">Squarer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="n">operand</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">operand</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div><p>I expect that our Squarer.calc method should be working correctly! And
here’s the output of running our test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m unittest test2
..
----------------------------------------------------------------------
Ran 2 tests in 0.000s

OK
$
</pre></div>
</div>
<p>Excellent! Our Squarer.calc method is working as expected. We wrote two
tests, test_positive_numbers and test_negative_numbers, and our
unittest script found no discrepancies between the expected and actual
behavior of Squarer.calc. Each test method that our code satisfies is
represented by a ‘.’ at the top of the output. The “OK” also signifies
that each test was passed by our code. Finally, if you’re a UNIX geek,
you’ll be interested to know that this test run produced a zero return
value.</p>
<p>We can also choose which tests to run. Calling&nbsp; <em>python -m unittest
test2</em> runs all of the tests in the test2.py file. If there were
multiple test classes in the test2 file, we could choose to run only the
SquarerTest tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m unittest test2.SquarerTest
..
----------------------------------------------------------------------
Ran 2 tests in 0.001s

OK
</pre></div>
</div>
<p>We can also choose to run just a single test within the SquarerTest
class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m unittest test2.SquarerTest.test_positive_numbers
.
----------------------------------------------------------------------
Ran 1 test in 0.000s

OK
</pre></div>
</div>
<p>Running just a single test at a time can be helpful if all of your tests
together take a long time to run, but you’re working on fixing a single
bug that’s covered by a single test. It is also useful if multiple tests
are failing and you are only working on one test.</p>
<p>Let’s modify our squarer.py file to produce an error and see how
unittest reports test failures. Modify squarer.py:</p>
<div
style#"background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># squarer.py</span>
<span class="k">class</span> <span class="nc">Squarer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="n">operand</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">operand</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># OLD</span>
        <span class="k">return</span> <span class="n">operand</span><span class="o">**</span><span class="n">operand</span>
</pre></div>
</div>
<p>Running our tests produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m unittest test2

FF
######################################################################
FAIL: test_negative_numbers (test2.SquarerTest)
----------------------------------------------------------------------
Traceback (most recent call last):
 File &quot;/Users/jaschilz/tmp/test2.py&quot;, line 32, in test_negative_numbers
 self.assertEqual(square, Squarer.calc(num), &quot;Squaring {}&quot;.format(num));
AssertionError: 1 !# -1.0 : Squaring -1

######################################################################
FAIL: test_positive_numbers (test2.SquarerTest)
----------------------------------------------------------------------
Traceback (most recent call last):
 File &quot;/Users/jaschilz/tmp/test2.py&quot;, line 19, in test_positive_numbers
 self.assertEqual(square, Squarer.calc(num), &quot;Squaring {}&quot;.format(num));
AssertionError: 9 !# 27 : Squaring 3

----------------------------------------------------------------------
Ran 2 tests in 0.001s

FAILED (failures#2)
</pre></div>
</div>
<p>Each test that failed is represented by an “F” at the top of the output.
If we are running multiple tests, with some passes and some failures, then
we would see a mix of “.”s and “F”s at the top of the output. In this
case, we ran two tests and both failed. If our code fails&nbsp;<em>any</em> tests,
then we will also see the word “FAILED” at the bottom of the output,
replacing “OK”. If you’re a UNIX geek, you might be interested to know
that this test run has produced a non-zero return value.</p>
<p>The unittest library also gives us detailed information about each test
that failed. Let’s look at the output for test_positive_numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>######################################################################
FAIL: test_positive_numbers (test2.SquarerTest)
----------------------------------------------------------------------
Traceback (most recent call last):
 File &quot;/Users/jaschilz/tmp/test2.py&quot;, line 19, in test_positive_numbers
 self.assertEqual(square, Squarer.calc(num), &quot;Squaring {}&quot;.format(num));
AssertionError: 9 !# 27 : Squaring 3

----------------------------------------------------------------------
</pre></div>
</div>
<p>We can see that the code failed its assertion on line 19. The unittest
library reports that the expected value, 9, was not equal to the
actual value of 27 produced by our code. We also see the helpful output
message that we created: “Squaring 3”. This tells us that the test
failed while attempting our test scenario for squaring the number 3.</p>
<p>Keep in mind that unittest will stop a test method as soon as it
encounters its first assertion error! Our Squarer.calc would
probably <em>also</em> fail to produce 144 when squaring 12, but our test
method will not move on to that scenario until our code passes the
scenario for squaring 3.</p>
<p>Now that we know that our change to squarer.py has introduced an error,
let’s revise our code to fix the error, re-run the tests, and see
that our code is working as expected once again.</p>
<div
style#"background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># squarer.py</span>
<span class="k">class</span> <span class="nc">Squarer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="n">operand</span><span class="p">):</span>
        <span class="c1">#return operand**2        # OLD</span>
        <span class="c1">#return operand**operand  # BAD</span>
        <span class="k">return</span> <span class="n">operand</span><span class="o">*</span><span class="n">operand</span>   <span class="c1"># This should work</span>
</pre></div>
</div>
</div><p>Running our tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m unittest test2
..
----------------------------------------------------------------------
Ran 2 tests in 0.001s

OK
</pre></div>
</div>
<p>Great! Our squarer works as expected again!</p>
<p>In practice you’ll probably always use unittest or another similar
library instead of your own, completely homegrown test scripts. This is
because the unittest library offers several useful features, and doesn’t require
much more typing than the homegrown test script example above. But the
unittest test methods we’ve written are not much different in <em>intent</em>
than the scripts you would come up with by yourself if you wanted to write
a script to test whether your code was functioning as intended.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="activity.html" class="btn btn-neutral float-right" title="Activity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="content_part05.html" class="btn btn-neutral" title="Part 5: Using Unittest" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, University of Washington, Christopher Barker, Luis Diego Conejo, Andy Miles, Rick Riehle, Joseph Schilz. Creative Commons Attribution-ShareAlike 3.0 license

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>